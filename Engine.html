<!DOCTYPE html>
<html>
<head>
  <meta charset="urf=8"/>
  <title>Escape From School</title>
  <style type="text/css">
    canvas{
      position: absolute;
      top: 0px;
      bottom: 0px;
      left: 0px;
      right: 0px;
      margin: auto;
  }
    </style>
</head>
<body>
<script>
  //variaveis do jogo
  var canvas, ctx, ALTURA, frames = 0, maxPulos = 3,
  chao = {
      y: 250,
      altura: 50,
      cor: "#000000",

      desenha: function(){
        ctx.fillStyle = this.cor;
        ctx.fillRect(0,this.y, LARGURA, this.altura);
      }
  },
  bloco = {
    x: 20,
    y: 250,
    altura: 10,
    largura: 10,
    cor: "#0000CD",
    gravidade: 1.5,
    velocidade: 0,
    forcaDoPulo: 10,
    qntPulos: 0,

    atualiza: function(){
      this.velocidade += this.gravidade;
      this.y += this.velocidade;

      if(this.y > chao.y - this.altura){
          this.y = chao.y - this.altura;
          this.qntPulos = 0;
      }
    },

    pula: function(){
      if(this.qntPulos < maxPulos){
        this.velocidade = -this.forcaDoPulo;
        this.qntPulos++;
                    
    }
    },
    moviment: function(){
      if (keyIsDown(LEFT_ARROW))
        x-=5;

     if (keyIsDown(RIGHT_ARROW))
        x+=5;

     if (keyIsDown(UP_ARROW))
         y-=5;

     if (keyIsDown(DOWN_ARROW))
       y+=5;
    },

    desenha: function(){
      ctx.fillStyle = this.cor;
      ctx.fillRect(this.x, this.y, this.largura, this.altura);
    }
    
  };

  function key(event) {
    bloco.pula();

  }
  function main() {
    ALTURA = window.innerHeight;
    LARGURA = window.innerWidth;

    if(LARGURA >=500){
      LARGURA = 1200;
      ALTURA = 300;
    }
    canvas = document.createElement("canvas");
    canvas.width = LARGURA;
    canvas.height = ALTURA;
    canvas.style.border = "1px solid #000";

    ctx = canvas.getContext("2d");
    document.body.appendChild(canvas);
    document.addEventListener("keyIsDown(UP_ARROW)", key);

    roda();
  }

  function roda() {
    atualiza();
    desenha();

    window.requestAnimationFrame(roda);
  }

  function atualiza() {
    frames++;
    bloco.atualiza();
  }

  function desenha() {
    ctx.fillStyle = "#B22222"
    ctx.fillRect(0,0, LARGURA, ALTURA);

    chao.desenha();
    bloco.desenha();
    bloco.moviment();
  }
  
  //inicialia o jogo
  main();
</script>
</body>
</html>